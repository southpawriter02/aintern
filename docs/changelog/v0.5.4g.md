# v0.5.4g - Terminal Context Attachment

**Released**: 2026-01-18

---

## Overview

ViewModels for attaching terminal output to AI chat context with capture management, display properties, and refresh capability.

---

## Added

### ViewModels (`AIntern.Desktop/ViewModels/`)

- **TerminalContextViewModel**
  - Observable: `Capture`, `IsExpanded`
  - Computed: `DisplayName`, `Preview`, `FullOutput`, `EstimatedTokens`, `IsTruncated`, `WorkingDirectory`, `Command`, `HasCommand`, `CaptureMode`, `CaptureModeText`, `CaptureTime`, `CaptureTimeText`, `ContextString`, `LineCount`, `OriginalLength`, `WasTruncated`, `TruncationText`
  - Commands: `ToggleExpandCommand`, `RefreshCommand`

- **TerminalContextViewModelFactory**
  - `Create(TerminalOutputCapture)` - From existing capture
  - `CreateFromFullBufferAsync(sessionId)` - Full buffer capture
  - `CreateFromLastLinesAsync(sessionId, lineCount)` - Last N lines
  - `CreateFromSelectionAsync(sessionId)` - User selection
  - `CreateFromActiveSessionAsync()` - Active session capture

### DI Registration (`ServiceCollectionExtensions.cs`)

- Registered `TerminalContextViewModelFactory` as singleton

---

## Unit Tests

34 tests in `TerminalContextViewModelTests.cs`:

| Class | Tests |
|-------|-------|
| TerminalContextViewModelTests | 28 |
| TerminalContextViewModelFactoryTests | 6 |

---

## Files Changed

| File | Status |
|------|--------|
| `ViewModels/TerminalContextViewModel.cs` | Added |
| `ViewModels/TerminalContextViewModelFactory.cs` | Added |
| `Extensions/ServiceCollectionExtensions.cs` | Modified |
| `AIntern.Desktop.Tests/ViewModels/TerminalContextViewModelTests.cs` | Added |

---

## Next Steps

- v0.5.5: Terminal Polish (settings, themes, keyboard shortcuts)
